<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <title>10000个压测(使用createRadialGradient)</title>
</head>

	<canvas id="mainCanvas" width="800" height="400" style="border: 1px red solid;" ></canvas>
	
	<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.js"></script>
	<script>
				
		var mainCanvas = document.getElementById('mainCanvas');
		var mainCtx = mainCanvas.getContext('2d');

		var radius = 20;
		var diameter = radius * 2;

		var data = createData();
		
		console.time();
		for(var i = 0, len = data.length; i < len; i ++) {
			var n1 = createNode(data[i].x, data[i].y);
		}
		
		console.timeEnd();
		
		colorize();
		function createNode(x, y) {
		
			var grd = mainCtx.createRadialGradient(x, y, 5, x, y, radius);

			grd.addColorStop(0, 'rgba(0,0,0,1)');
			grd.addColorStop(1, 'rgba(0,0,0,0)');
			//使用经向渐变
			mainCtx.fillStyle = grd;
			mainCtx.fillRect(x - radius, y - radius, diameter, diameter);
		}
		
		function createData() {
			
			//return [{"x":986,"y":530},{"x":234,"y":354},{"x":361,"y":825},{"x":877,"y":175},{"x":717,"y":394},{"x":56,"y":84},{"x":904,"y":482},{"x":349,"y":11},{"x":109,"y":27},{"x":554,"y":468},{"x":75,"y":888},{"x":190,"y":267},{"x":316,"y":17},{"x":908,"y":433},{"x":775,"y":821},{"x":427,"y":541},{"x":932,"y":760},{"x":862,"y":876},{"x":711,"y":307},{"x":990,"y":557},{"x":174,"y":100},{"x":6,"y":897},{"x":621,"y":294},{"x":747,"y":776},{"x":494,"y":982},{"x":211,"y":922},{"x":483,"y":494},{"x":844,"y":918},{"x":62,"y":935},{"x":846,"y":55},{"x":942,"y":602},{"x":385,"y":314},{"x":42,"y":167},{"x":951,"y":501},{"x":981,"y":692},{"x":104,"y":766},{"x":390,"y":268},{"x":26,"y":461},{"x":656,"y":351},{"x":403,"y":788},{"x":15,"y":645},{"x":738,"y":617},{"x":390,"y":544},{"x":39,"y":654},{"x":754,"y":516},{"x":936,"y":78},{"x":260,"y":151},{"x":618,"y":537},{"x":615,"y":880},{"x":473,"y":612},{"x":298,"y":578},{"x":537,"y":635},{"x":837,"y":769},{"x":139,"y":951},{"x":366,"y":715},{"x":7,"y":633},{"x":704,"y":843},{"x":798,"y":944},{"x":951,"y":787},{"x":790,"y":133},{"x":858,"y":820},{"x":821,"y":770},{"x":999,"y":957},{"x":301,"y":977},{"x":271,"y":203},{"x":116,"y":45},{"x":327,"y":604},{"x":540,"y":224},{"x":739,"y":915},{"x":554,"y":388},{"x":728,"y":265},{"x":587,"y":416},{"x":358,"y":500},{"x":846,"y":521},{"x":79,"y":586},{"x":871,"y":391},{"x":931,"y":635},{"x":759,"y":450},{"x":30,"y":841},{"x":782,"y":801},{"x":235,"y":646},{"x":845,"y":377},{"x":583,"y":69},{"x":866,"y":761},{"x":464,"y":767},{"x":372,"y":261},{"x":941,"y":325},{"x":495,"y":521},{"x":945,"y":748},{"x":728,"y":353},{"x":152,"y":21},{"x":388,"y":360},{"x":287,"y":631},{"x":424,"y":193},{"x":877,"y":682},{"x":284,"y":301},{"x":547,"y":825},{"x":132,"y":407},{"x":469,"y":480},{"x":227,"y":414},{"x":579,"y":283},{"x":25,"y":116},{"x":801,"y":259},{"x":160,"y":515},{"x":132,"y":556},{"x":622,"y":948},{"x":106,"y":771},{"x":697,"y":166},{"x":859,"y":412},{"x":858,"y":919},{"x":913,"y":987},{"x":664,"y":658},{"x":403,"y":229},{"x":412,"y":94},{"x":432,"y":678},{"x":802,"y":323},{"x":337,"y":409},{"x":165,"y":26},{"x":247,"y":845},{"x":689,"y":363},{"x":81,"y":474},{"x":368,"y":781},{"x":611,"y":813},{"x":98,"y":0},{"x":710,"y":634},{"x":879,"y":462},{"x":387,"y":670},{"x":345,"y":363},{"x":98,"y":264},{"x":272,"y":243},{"x":339,"y":943},{"x":649,"y":39},{"x":346,"y":556},{"x":740,"y":393},{"x":19,"y":217},{"x":273,"y":728},{"x":220,"y":691},{"x":482,"y":766},{"x":869,"y":477},{"x":400,"y":371},{"x":227,"y":861},{"x":651,"y":824},{"x":688,"y":197},{"x":887,"y":838},{"x":320,"y":860},{"x":437,"y":626},{"x":832,"y":766},{"x":864,"y":456},{"x":980,"y":346},{"x":521,"y":277},{"x":936,"y":785},{"x":789,"y":246},{"x":161,"y":99},{"x":592,"y":573},{"x":683,"y":184},{"x":133,"y":543},{"x":418,"y":927},{"x":944,"y":171},{"x":330,"y":175},{"x":82,"y":604},{"x":671,"y":218},{"x":590,"y":281},{"x":632,"y":13},{"x":416,"y":513},{"x":900,"y":540},{"x":170,"y":316},{"x":604,"y":339},{"x":178,"y":160},{"x":959,"y":456},{"x":956,"y":294},{"x":978,"y":763},{"x":287,"y":985},{"x":531,"y":96},{"x":51,"y":885},{"x":538,"y":204},{"x":199,"y":634},{"x":133,"y":588},{"x":231,"y":756},{"x":266,"y":375},{"x":931,"y":918},{"x":545,"y":677},{"x":939,"y":262},{"x":894,"y":134},{"x":185,"y":685},{"x":827,"y":84},{"x":263,"y":127},{"x":600,"y":129},{"x":999,"y":287},{"x":728,"y":599},{"x":626,"y":815},{"x":591,"y":641},{"x":565,"y":185},{"x":226,"y":754},{"x":39,"y":322},{"x":376,"y":988},{"x":30,"y":354},{"x":263,"y":880},{"x":53,"y":974},{"x":428,"y":10},{"x":606,"y":853},{"x":112,"y":991},{"x":280,"y":808},{"x":375,"y":908},{"x":994,"y":139},{"x":668,"y":793},{"x":112,"y":275},{"x":909,"y":851},{"x":455,"y":800},{"x":912,"y":687},{"x":643,"y":359},{"x":990,"y":330},{"x":663,"y":286},{"x":177,"y":898},{"x":664,"y":76},{"x":795,"y":853},{"x":626,"y":798},{"x":62,"y":888},{"x":466,"y":890},{"x":144,"y":791},{"x":153,"y":28},{"x":23,"y":298},{"x":417,"y":381},{"x":217,"y":220},{"x":583,"y":318},{"x":186,"y":980},{"x":199,"y":153},{"x":795,"y":692},{"x":538,"y":478},{"x":1,"y":977},{"x":7,"y":578},{"x":153,"y":736},{"x":453,"y":257},{"x":288,"y":124},{"x":738,"y":442},{"x":201,"y":960},{"x":705,"y":754},{"x":771,"y":759},{"x":419,"y":538},{"x":369,"y":29},{"x":652,"y":940},{"x":985,"y":916},{"x":157,"y":87},{"x":421,"y":479},{"x":374,"y":989},{"x":277,"y":498},{"x":405,"y":165},{"x":849,"y":81},{"x":140,"y":656},{"x":615,"y":493},{"x":589,"y":375},{"x":492,"y":878},{"x":146,"y":377},{"x":320,"y":635},{"x":251,"y":920},{"x":529,"y":163},{"x":414,"y":969},{"x":420,"y":9},{"x":751,"y":189},{"x":612,"y":668},{"x":792,"y":434},{"x":245,"y":577},{"x":381,"y":263},{"x":412,"y":687},{"x":877,"y":144},{"x":116,"y":196},{"x":417,"y":615},{"x":901,"y":576},{"x":412,"y":469},{"x":899,"y":191},{"x":496,"y":218},{"x":802,"y":19},{"x":549,"y":749},{"x":489,"y":43},{"x":358,"y":516},{"x":606,"y":31},{"x":27,"y":74},{"x":357,"y":749},{"x":924,"y":493},{"x":378,"y":832},{"x":802,"y":771},{"x":234,"y":988},{"x":350,"y":658},{"x":369,"y":105},{"x":24,"y":340},{"x":771,"y":271},{"x":750,"y":248},{"x":980,"y":118},{"x":675,"y":163},{"x":119,"y":778},{"x":628,"y":632},{"x":23,"y":53},{"x":692,"y":626},{"x":160,"y":189},{"x":903,"y":548},{"x":734,"y":813},{"x":950,"y":251},{"x":151,"y":240},{"x":93,"y":971},{"x":988,"y":597},{"x":962,"y":802},{"x":820,"y":689},{"x":649,"y":836},{"x":916,"y":543},{"x":289,"y":674},{"x":999,"y":471},{"x":104,"y":162},{"x":413,"y":342},{"x":867,"y":176},{"x":248,"y":299},{"x":48,"y":401},{"x":134,"y":980},{"x":328,"y":353},{"x":341,"y":559},{"x":25,"y":855},{"x":635,"y":730},{"x":616,"y":427},{"x":353,"y":870},{"x":883,"y":32},{"x":50,"y":652},{"x":294,"y":111},{"x":13,"y":776},{"x":780,"y":724},{"x":18,"y":385},{"x":0,"y":893},{"x":918,"y":237},{"x":881,"y":925},{"x":43,"y":623},{"x":394,"y":21},{"x":183,"y":120},{"x":815,"y":916},{"x":809,"y":107},{"x":116,"y":936},{"x":473,"y":34},{"x":161,"y":644},{"x":546,"y":156},{"x":948,"y":58},{"x":5,"y":623},{"x":580,"y":4},{"x":544,"y":326},{"x":827,"y":994},{"x":782,"y":167},{"x":561,"y":328},{"x":49,"y":168},{"x":889,"y":644},{"x":257,"y":796},{"x":879,"y":876},{"x":404,"y":363},{"x":771,"y":641},{"x":667,"y":739},{"x":84,"y":838},{"x":422,"y":100},{"x":54,"y":377},{"x":968,"y":241},{"x":264,"y":271},{"x":835,"y":788},{"x":805,"y":139},{"x":584,"y":132},{"x":800,"y":132},{"x":436,"y":940},{"x":547,"y":157},{"x":398,"y":53},{"x":917,"y":740},{"x":33,"y":335},{"x":739,"y":111},{"x":918,"y":877},{"x":86,"y":806},{"x":148,"y":913},{"x":410,"y":997},{"x":490,"y":170},{"x":271,"y":355},{"x":715,"y":886},{"x":625,"y":663},{"x":985,"y":293},{"x":300,"y":479},{"x":427,"y":522},{"x":985,"y":370},{"x":641,"y":354},{"x":64,"y":228},{"x":672,"y":47},{"x":556,"y":457},{"x":725,"y":912},{"x":605,"y":315},{"x":681,"y":678},{"x":920,"y":896},{"x":791,"y":353},{"x":256,"y":213},{"x":347,"y":520},{"x":234,"y":604},{"x":397,"y":572},{"x":723,"y":762},{"x":456,"y":40},{"x":803,"y":51},{"x":823,"y":806},{"x":465,"y":655},{"x":157,"y":150},{"x":854,"y":246},{"x":729,"y":173},{"x":602,"y":6},{"x":118,"y":674},{"x":16,"y":711},{"x":625,"y":281},{"x":399,"y":64},{"x":888,"y":120},{"x":483,"y":869},{"x":438,"y":255},{"x":357,"y":693},{"x":598,"y":654},{"x":630,"y":947},{"x":404,"y":81},{"x":340,"y":915},{"x":471,"y":555},{"x":334,"y":175},{"x":918,"y":641},{"x":479,"y":352},{"x":7,"y":546},{"x":960,"y":385},{"x":105,"y":920},{"x":668,"y":507},{"x":596,"y":162},{"x":171,"y":15},{"x":22,"y":921},{"x":56,"y":885},{"x":558,"y":8},{"x":129,"y":326},{"x":651,"y":933},{"x":412,"y":49},{"x":536,"y":522},{"x":16,"y":354},{"x":606,"y":321},{"x":522,"y":478},{"x":711,"y":833},{"x":409,"y":827},{"x":318,"y":972},{"x":236,"y":445},{"x":735,"y":76},{"x":57,"y":899},{"x":102,"y":90},{"x":952,"y":397},{"x":59,"y":294},{"x":186,"y":184},{"x":748,"y":420},{"x":74,"y":391},{"x":611,"y":656},{"x":907,"y":529},{"x":844,"y":148},{"x":908,"y":854},{"x":98,"y":410},{"x":690,"y":983},{"x":80,"y":466},{"x":128,"y":714},{"x":270,"y":785},{"x":247,"y":137},{"x":456,"y":335},{"x":589,"y":392},{"x":451,"y":723},{"x":921,"y":610},{"x":366,"y":807},{"x":227,"y":396},{"x":113,"y":630},{"x":193,"y":466},{"x":75,"y":828},{"x":197,"y":856},{"x":223,"y":54},{"x":542,"y":509},{"x":211,"y":539},{"x":146,"y":277},{"x":507,"y":350},{"x":748,"y":824},{"x":30,"y":116},{"x":62,"y":577},{"x":392,"y":222},{"x":270,"y":884},{"x":748,"y":933},{"x":259,"y":317},{"x":119,"y":182},{"x":721,"y":124},{"x":626,"y":369},{"x":539,"y":187},{"x":417,"y":655},{"x":725,"y":865},{"x":172,"y":53},{"x":329,"y":72},{"x":844,"y":842},{"x":859,"y":580},{"x":8,"y":691},{"x":373,"y":225},{"x":367,"y":168},{"x":409,"y":342},{"x":312,"y":638},{"x":700,"y":524},{"x":350,"y":964},{"x":979,"y":270},{"x":738,"y":409},{"x":379,"y":761},{"x":789,"y":749},{"x":197,"y":252},{"x":589,"y":143},{"x":254,"y":828},{"x":49,"y":317},{"x":837,"y":727},{"x":644,"y":424},{"x":929,"y":308},{"x":114,"y":101},{"x":443,"y":812},{"x":684,"y":722},{"x":241,"y":417},{"x":255,"y":601},{"x":560,"y":748},{"x":346,"y":111},{"x":262,"y":182},{"x":864,"y":39},{"x":705,"y":227},{"x":443,"y":218},{"x":278,"y":572},{"x":704,"y":592},{"x":303,"y":160},{"x":199,"y":172},{"x":215,"y":642},{"x":723,"y":466},{"x":939,"y":660},{"x":419,"y":936},{"x":151,"y":276},{"x":601,"y":836},{"x":27,"y":618},{"x":108,"y":507},{"x":301,"y":651},{"x":113,"y":449},{"x":58,"y":849},{"x":184,"y":6},{"x":131,"y":31},{"x":323,"y":957},{"x":128,"y":646},{"x":734,"y":968},{"x":615,"y":760},{"x":216,"y":479},{"x":11,"y":497},{"x":614,"y":520},{"x":574,"y":957},{"x":237,"y":983},{"x":737,"y":253},{"x":367,"y":317},{"x":958,"y":950},{"x":146,"y":187},{"x":508,"y":192},{"x":480,"y":525},{"x":425,"y":736},{"x":517,"y":273},{"x":797,"y":971},{"x":838,"y":101},{"x":598,"y":135},{"x":676,"y":587},{"x":673,"y":895},{"x":292,"y":650},{"x":31,"y":774},{"x":774,"y":269},{"x":246,"y":129},{"x":64,"y":183},{"x":405,"y":798},{"x":237,"y":222},{"x":648,"y":624},{"x":781,"y":71},{"x":985,"y":242},{"x":519,"y":889},{"x":697,"y":90},{"x":780,"y":420},{"x":172,"y":868},{"x":667,"y":721},{"x":501,"y":11},{"x":372,"y":506},{"x":384,"y":476},{"x":695,"y":183},{"x":401,"y":887},{"x":646,"y":627},{"x":703,"y":490},{"x":897,"y":143},{"x":964,"y":527},{"x":687,"y":869},{"x":887,"y":355},{"x":818,"y":595},{"x":230,"y":503},{"x":308,"y":818},{"x":770,"y":752},{"x":52,"y":179},{"x":431,"y":911},{"x":225,"y":641},{"x":381,"y":734},{"x":917,"y":248},{"x":295,"y":341},{"x":2,"y":142},{"x":839,"y":184},{"x":344,"y":89},{"x":750,"y":296},{"x":29,"y":889},{"x":376,"y":642},{"x":587,"y":916},{"x":441,"y":806},{"x":634,"y":847},{"x":706,"y":107},{"x":107,"y":296},{"x":657,"y":496},{"x":106,"y":211},{"x":507,"y":519},{"x":654,"y":487},{"x":414,"y":456},{"x":203,"y":959},{"x":718,"y":783},{"x":284,"y":715},{"x":80,"y":438},{"x":612,"y":185},{"x":821,"y":674},{"x":726,"y":653},{"x":988,"y":55},{"x":271,"y":235},{"x":334,"y":966},{"x":261,"y":476},{"x":657,"y":455},{"x":893,"y":868},{"x":410,"y":125},{"x":869,"y":485},{"x":166,"y":611},{"x":160,"y":117},{"x":896,"y":121},{"x":112,"y":265},{"x":255,"y":541},{"x":975,"y":897},{"x":368,"y":549},{"x":308,"y":390},{"x":790,"y":31},{"x":395,"y":774},{"x":189,"y":488},{"x":175,"y":493},{"x":855,"y":81},{"x":130,"y":313},{"x":149,"y":162},{"x":537,"y":605},{"x":85,"y":232},{"x":676,"y":442},{"x":261,"y":246},{"x":199,"y":538},{"x":369,"y":649},{"x":448,"y":24},{"x":445,"y":223},{"x":342,"y":693},{"x":935,"y":224},{"x":378,"y":214},{"x":156,"y":549},{"x":603,"y":643},{"x":559,"y":129},{"x":760,"y":28},{"x":773,"y":727},{"x":904,"y":674},{"x":34,"y":402},{"x":502,"y":878},{"x":979,"y":668},{"x":333,"y":166},{"x":745,"y":613},{"x":161,"y":752},{"x":20,"y":967},{"x":68,"y":323},{"x":790,"y":530},{"x":141,"y":167},{"x":226,"y":293},{"x":640,"y":535},{"x":188,"y":778},{"x":105,"y":707},{"x":298,"y":965},{"x":948,"y":871},{"x":758,"y":69},{"x":738,"y":94},{"x":948,"y":416},{"x":602,"y":446},{"x":156,"y":705},{"x":296,"y":253},{"x":95,"y":442},{"x":542,"y":893},{"x":454,"y":313},{"x":789,"y":279},{"x":944,"y":361},{"x":213,"y":396},{"x":13,"y":356},{"x":181,"y":604},{"x":814,"y":418},{"x":450,"y":497},{"x":856,"y":221},{"x":757,"y":562},{"x":161,"y":72},{"x":294,"y":677},{"x":656,"y":362},{"x":429,"y":545},{"x":130,"y":263},{"x":256,"y":368},{"x":836,"y":622},{"x":206,"y":449},{"x":157,"y":301},{"x":945,"y":701},{"x":354,"y":176},{"x":622,"y":649},{"x":752,"y":346},{"x":154,"y":696},{"x":924,"y":793},{"x":681,"y":693},{"x":666,"y":24},{"x":45,"y":819},{"x":591,"y":628},{"x":766,"y":826},{"x":483,"y":432},{"x":742,"y":90},{"x":227,"y":874},{"x":464,"y":985},{"x":13,"y":468},{"x":996,"y":724},{"x":426,"y":264},{"x":637,"y":607},{"x":919,"y":693},{"x":268,"y":13},{"x":132,"y":254},{"x":602,"y":370},{"x":971,"y":785},{"x":86,"y":274},{"x":650,"y":562},{"x":540,"y":650},{"x":395,"y":711},{"x":485,"y":903},{"x":569,"y":883},{"x":994,"y":845},{"x":622,"y":825},{"x":331,"y":63},{"x":81,"y":365},{"x":871,"y":698},{"x":795,"y":197},{"x":94,"y":377},{"x":385,"y":410},{"x":896,"y":501},{"x":218,"y":417},{"x":189,"y":55},{"x":131,"y":390},{"x":730,"y":203},{"x":943,"y":619},{"x":504,"y":332},{"x":885,"y":7},{"x":419,"y":449},{"x":931,"y":240},{"x":770,"y":923},{"x":741,"y":400},{"x":103,"y":689},{"x":461,"y":699},{"x":549,"y":541},{"x":839,"y":806},{"x":374,"y":368},{"x":993,"y":48},{"x":403,"y":62},{"x":768,"y":932},{"x":837,"y":981},{"x":469,"y":197},{"x":951,"y":584},{"x":846,"y":322},{"x":0,"y":575},{"x":643,"y":773},{"x":887,"y":523},{"x":672,"y":995},{"x":138,"y":555},{"x":544,"y":895},{"x":62,"y":497},{"x":478,"y":406},{"x":376,"y":634},{"x":935,"y":9},{"x":764,"y":250},{"x":561,"y":62},{"x":197,"y":935},{"x":344,"y":0},{"x":928,"y":785},{"x":999,"y":180},{"x":149,"y":424},{"x":383,"y":685},{"x":36,"y":613},{"x":259,"y":438},{"x":982,"y":472},{"x":212,"y":735},{"x":573,"y":102},{"x":748,"y":807},{"x":236,"y":893},{"x":621,"y":794},{"x":327,"y":661},{"x":323,"y":106},{"x":362,"y":781},{"x":917,"y":110},{"x":307,"y":837},{"x":809,"y":736},{"x":645,"y":479},{"x":276,"y":356},{"x":131,"y":575},{"x":628,"y":151},{"x":242,"y":236},{"x":626,"y":434},{"x":503,"y":929},{"x":644,"y":836},{"x":832,"y":722},{"x":877,"y":803},{"x":100,"y":409},{"x":590,"y":352},{"x":434,"y":286},{"x":84,"y":119},{"x":201,"y":685},{"x":727,"y":967},{"x":609,"y":629},{"x":938,"y":801},{"x":491,"y":730},{"x":604,"y":600},{"x":509,"y":146},{"x":492,"y":906},{"x":724,"y":254},{"x":423,"y":891},{"x":491,"y":112},{"x":913,"y":865},{"x":804,"y":24},{"x":657,"y":164},{"x":854,"y":508},{"x":82,"y":237},{"x":118,"y":837},{"x":138,"y":969},{"x":279,"y":792},{"x":44,"y":450},{"x":598,"y":534},{"x":857,"y":588},{"x":335,"y":21},{"x":657,"y":225},{"x":752,"y":319},{"x":775,"y":585},{"x":835,"y":46},{"x":29,"y":517},{"x":807,"y":198},{"x":553,"y":656},{"x":876,"y":428},{"x":533,"y":435},{"x":497,"y":152},{"x":448,"y":289},{"x":365,"y":318},{"x":145,"y":765},{"x":599,"y":650},{"x":683,"y":745},{"x":137,"y":2},{"x":606,"y":228},{"x":733,"y":407},{"x":892,"y":298},{"x":776,"y":91},{"x":486,"y":624},{"x":321,"y":658},{"x":548,"y":750},{"x":943,"y":272},{"x":472,"y":890},{"x":754,"y":739},{"x":369,"y":369},{"x":625,"y":174},{"x":849,"y":954},{"x":946,"y":864},{"x":111,"y":763},{"x":134,"y":173},{"x":182,"y":372},{"x":573,"y":635},{"x":319,"y":490},{"x":619,"y":45},{"x":225,"y":285},{"x":678,"y":326},{"x":903,"y":292},{"x":137,"y":379},{"x":243,"y":361},{"x":266,"y":943},{"x":436,"y":894},{"x":476,"y":789},{"x":846,"y":55},{"x":372,"y":376},{"x":646,"y":843},{"x":364,"y":284},{"x":215,"y":272},{"x":219,"y":256},{"x":19,"y":624},{"x":164,"y":488},{"x":232,"y":819},{"x":598,"y":176},{"x":416,"y":924},{"x":549,"y":515},{"x":368,"y":503},{"x":134,"y":929},{"x":27,"y":298},{"x":577,"y":129},{"x":137,"y":92},{"x":983,"y":176},{"x":432,"y":750},{"x":387,"y":809},{"x":973,"y":559},{"x":138,"y":347},{"x":945,"y":3},{"x":429,"y":672},{"x":899,"y":177},{"x":644,"y":162},{"x":501,"y":120},{"x":51,"y":284},{"x":178,"y":81},{"x":713,"y":733},{"x":446,"y":422},{"x":8,"y":464},{"x":332,"y":954},{"x":595,"y":769},{"x":23,"y":909},{"x":847,"y":441},{"x":541,"y":28},{"x":575,"y":623},{"x":117,"y":19},{"x":388,"y":348},{"x":41,"y":384},{"x":684,"y":401},{"x":665,"y":653},{"x":151,"y":973},{"x":356,"y":691},{"x":896,"y":273},{"x":865,"y":406},{"x":498,"y":581},{"x":396,"y":460},{"x":748,"y":65},{"x":512,"y":665},{"x":265,"y":495},{"x":950,"y":896},{"x":759,"y":35},{"x":863,"y":374},{"x":599,"y":155},{"x":579,"y":331},{"x":440,"y":90},{"x":261,"y":829},{"x":243,"y":25},{"x":755,"y":201},{"x":550,"y":712},{"x":147,"y":579},{"x":512,"y":140},{"x":264,"y":198},{"x":362,"y":242},{"x":227,"y":478},{"x":136,"y":147},{"x":591,"y":36},{"x":375,"y":317},{"x":846,"y":47},{"x":147,"y":536},{"x":110,"y":780},{"x":511,"y":681},{"x":909,"y":643},{"x":42,"y":126},{"x":875,"y":948},{"x":800,"y":914},{"x":409,"y":420},{"x":385,"y":616},{"x":639,"y":718},{"x":675,"y":165},{"x":363,"y":977},{"x":919,"y":693},{"x":415,"y":328},{"x":189,"y":436},{"x":456,"y":587},{"x":71,"y":726},{"x":722,"y":445},{"x":109,"y":847},{"x":651,"y":321},{"x":985,"y":976},{"x":821,"y":16},{"x":483,"y":258},{"x":894,"y":602},{"x":873,"y":505},{"x":724,"y":327},{"x":498,"y":524},{"x":103,"y":296},{"x":85,"y":894},{"x":963,"y":574},{"x":487,"y":652},{"x":2,"y":377},{"x":218,"y":176},{"x":925,"y":292},{"x":355,"y":563},{"x":283,"y":430},{"x":265,"y":259},{"x":42,"y":501},{"x":505,"y":774},{"x":997,"y":518},{"x":831,"y":892},{"x":550,"y":532},{"x":199,"y":621},{"x":123,"y":625},{"x":728,"y":188},{"x":759,"y":330},{"x":75,"y":477},{"x":334,"y":635},{"x":224,"y":462},{"x":574,"y":383},{"x":350,"y":752},{"x":665,"y":464},{"x":407,"y":118},{"x":13,"y":763},{"x":339,"y":980},{"x":194,"y":159},{"x":243,"y":213},{"x":550,"y":647},{"x":968,"y":369},{"x":448,"y":682}]
			var a = [];
			for(var i = 0; i < 1000; i ++) {
				a[i] = {
					x: parseInt(Math.random() * 1000),
					y: parseInt(Math.random() * 1000)
				}
			}
			return a;
		
		}
		
		
		function colorize() {
			var colorPalette = getColorPalette();
				// 取得图像
			// 上色
			console.time();
			var img = mainCtx.getImageData(0, 0, mainCanvas.width, mainCanvas.height);
			
			console.timeEnd();
			var imgData = img.data;
			var len = imgData.length;
			
			for (var i = 3; i < len; i += 4) {
				var alpha = imgData[i];
				
				if (alpha) {
					/**
					 * offset = alpha * 4
					 * 是因为canvas中图像是Uint8ClampedArray数组
					 * 每个像素由数组中连续排列的4个数组值组成, 分别代表rgba
					 */
					var offset = alpha * 4;
					//alpha = (alpha < opt.opacity) ? alpha : opt.opacity;
					
					imgData[i - 3] = colorPalette[offset];      // red
					imgData[i - 2] = colorPalette[offset + 1];  // green
					imgData[i - 1] = colorPalette[offset + 2];  // blue
					//imgData[i] == alpha;                         // alpha
					
					
				}
			}
			
			mainCtx.putImageData(img, 0, 0);
		}
		function getColorPalette() {
			var opt = this.opt;
			var gradientConfig = {
				0.45: "rgb(0, 0, 255)",
				0.55: "rgb(0, 255, 255)",
				0.65: "rgb(0, 255, 0)",
				0.95: "rgb(255, 255, 0)",
				1.0: "rgb(255, 0, 0)"
			};
			var gradientConfig = {
				0.1: "rgb(0, 0, 0)",
				0.23: "rgb(0, 0, 255)",
				0.25: "rgb(0, 255, 255)",
				0.5: "rgb(0, 255, 0)",
				0.75: "rgb(255, 255, 0)",
				1.0: "rgb(255, 0, 0)"
			};
			var paletteCanvas = document.createElement('canvas');
			var paletteCtx = paletteCanvas.getContext('2d');

			paletteCanvas.width = 10;
			paletteCanvas.height = 256;

			var gradient = paletteCtx.createLinearGradient(0, 0, 1, 256);
			for (var key in gradientConfig) {
				gradient.addColorStop(key, gradientConfig[key]);
			}
			
			document.body.appendChild(paletteCanvas);

			paletteCtx.fillStyle = gradient;
			paletteCtx.fillRect(0, 0, 10, 256);

			return paletteCtx.getImageData(0, 0, 1, 256).data;
		}

	</script>

<body>
</html>